
<!-- Departments List -->

<section class = "content page invisible" ng-controller = "depsCtrl"
  ag-class = "{'content-hide': 'invisible', 'content-departments': '!invisible'}"
  ag-init = "$scope.initScope()">

  <div class = "content-wrapper">
    <div ng-repeat-start = "d in filtered track by d.uuid" uuid = "{{d.uuid}}"
      class = "section-list-repeated department" ng-class = "{odd: $odd}">

      <div class = "compacted line" ng-if = "view.obj != d.uuid">
        <div class = "icons">
          <table><tr><td><span class = "btn btn-icon"
            ng-click = "view.obj = d.uuid; view.emps = null"
            ><i class = "fa fa-eye"></i></span></td></tr></table>
        </div>
        <div class = "name">{{d.name}}</div>
      </div>

      <form class = "expanded block" ng-if = "view.obj == d.uuid">
        <div class = "form-group">
          <label>Department name</label>
          <input type = "text" class = "form-control" ng-model = "d.name"
            placeholder = "Set department name that is requiredâ€¦">
        </div>

        <div class = "row">
          <div class = "col-md-6 col-sm-12">
            <div class = "form-group">
              <label>Office</label>
              <input type = "text" class = "form-control" ng-model = "d.office">
            </div>
          </div>

          <div class = "col-md-6 col-sm-12">
            <div class = "form-group">
              <label>Phone</label>
              <input type = "text" class = "form-control" ng-model = "d.phone">
            </div>
          </div>
        </div>

        <div class = "row">
          <div class = "col-sm-8">
            <div class = "form-group">
              <label>Head</label>
              <input type = "text" class = "form-control" readonly ng-value = "headName(d)">
            </div>
          </div>

          <div class = "col-sm-4">
            <div class = "form-group">
              <label>Since</label>
              <input type = "text" class = "date-input-value-copy" model = "d.head.since">
              <div class = "input-group">
                <input type = "text" class = "form-control" readonly
                  ng-value = "d.head.since | date : 'MMMM d, yyyy' : 'UTC'"
                  ag-init = "$scope.initDatePicker($element, $element.parent().prev())">
                <div class = "input-group-addon"><span class = "btn btn-icon"><i class = "fa fa-calendar-o"></i></span></div>
              </div>
            </div>
          </div>
        </div>

        <div ag-trim class = "buttons">
          <div class = "left">
            <button ng-click = "view.obj = view.emps = null"
              class = "btn btn-default">Close</button>
            <button ng-click = "view.emps = (view.emps == d.uuid)?(null):(d.uuid)"
              class = "btn btn-info">View employees</button>
          </div>

          <div class = "right">
            <button class = "btn btn-warning">Select head</button>
            <button class = "btn btn-success">Commit</button>
          </div>
        </div>
      </form>
    </div>

    <!-- list the persons of this department -->
    <div ng-repeat = "e in listDepEmps(d) track by e.uuid"
      class = "section-list-repeated inner alter employee"
      ng-class = "{odd: $odd}">

      <div class = "compacted line">
        <div class = "icons">
          <table><tr><td><span class = "btn btn-icon" ng-click = "gotoEmp(e)"
            ><i class = "fa fa-eye"></i></span></td></tr></table>
        </div>
        <div class = "name">{{personName(e)}}</div>
      </div>
    </div>

    <div class = "section-list-sep" ng-repeat-end></div>
  </div>
</section>