
<!-- Employees List -->

<section class = "content page hidden" ng-controller = "empsCtrl"
  ag-class = "{'content-hide': 'hidden', 'content-employees': '!hidden'}"
  ag-init = "$scope.initScope()">

  <div class = "content-wrapper">

    <div ag-class = "{'toggle-content-menu': '~hidden', 'content-hide': 'hidden'}"
      class = "content-menu hidden">

      <div class = "buttons">
        <div class = "right">
          <btn ng-click = "view.obj = emps[NU]"
            class = "btn btn-warning">Add employee</btn>
        </div>
      </div>
    </div>

    <div ng-repeat-start = "e in emps track by e.uuid" uuid = "{{e.uuid}}"
      class = "section-list-repeated employee" ng-class = "{odd: $odd}"
      ng-if = "NU != e.uuid || NU == view.obj.uuid">

      <div ag-trim class = "compacted line" ng-if = "view.obj.uuid != e.uuid">
        <div class = "icons">
          <table><tr><td><span ng-click = "view.obj = ZeT.deepClone(e); view.seldep = null"
            class = "btn btn-icon"><i class = "fa fa-eye"></i></span></td></tr></table>
        </div>
        <div class = "name half">{{personName(e)}}</div>
        <span class = "sep"></span>
        <div class = "department half">{{depName(e)}}</div>
      </div>

      <form class = "expanded block" ng-if = "view.obj.uuid == e.uuid">
        <div class = "row">
          <div class = "col-sm-4 col-xs-12">
            <div class = "form-group first-name">
              <label>First name</label>
              <input type = "text" class = "form-control" ng-model = "view.obj.firstName"
                placeholder = "Set required first name…">
            </div>
          </div>

          <div class = "col-sm-4 col-xs-12">
            <div class = "form-group">
              <label>Middle name</label>
              <input type = "text" class = "form-control" ng-model = "view.obj.middleName">
            </div>
          </div>

          <div class = "col-sm-4 col-xs-12">
            <div class = "form-group last-name">
              <label>Last name</label>
              <input type = "text" class = "form-control" ng-model = "view.obj.lastName"
                placeholder = "Set required last name…">
            </div>
          </div>
        </div>

        <div class = "row">
          <div class = "col-md-4 col-sm-6 col-xs-12">
            <div class = "form-group">
              <label>Date of birth</label>
              <input type = "text" class = "date-input-value-copy" ng-model = "view.obj.dob">
              <div class = "input-group">
                <input type = "text" class = "form-control" readonly
                  ng-value = "view.obj.dob | date : 'MMMM d, yyyy' : 'UTC'"
                  ag-init = "$scope.initDatePicker($element, $element.parent().prev())">
                <div class = "input-group-addon"><span class = "btn btn-icon"><i class = "fa fa-calendar-o"></i></span></div>
              </div>
            </div>
          </div>

          <div ag-trim class = "col-md-8 col-sm-6 col-xs-12">
            <div class = "form-group">
              <label>Sex</label>
              <div class = "cell-bottom" ag-init = "$scope.matchHeight($element,
                $element.parent().parent().prev().find('.form-control'))">

                <span class = "checkbox checkbox-inline" ng-click = "view.obj.sex = (view.obj.sex == 'M')?(null):('M')">
                  <input type = "checkbox" ng-checked = "view.obj.sex == 'M'"><label>Male</label>
                </span>

                <span class = "checkbox checkbox-inline" ng-click = "view.obj.sex = (view.obj.sex == 'F')?(null):('F')">
                  <input type = "checkbox" ng-checked = "view.obj.sex == 'F'"><label>Female</label>
                </span>
              </div>
            </div>
          </div>
        </div>

        <div class = "row">
          <div class = "col-sm-6 col-xs-12">
            <div class = "form-group">
              <label>Personal email</label>
              <input type = "text" class = "form-control" ng-model = "view.obj.email">
            </div>
          </div>

          <div class = "col-sm-6 col-xs-12">
            <div class = "form-group">
              <label>Personal phone</label>
              <input type = "text" class = "form-control" ng-model = "view.obj.phone">
            </div>
          </div>
        </div>

        <div class = "row">
          <div class = "col-xs-12">
            <div class = "form-group">
              <label>Home address</label>
              <input type = "text" class = "form-control" ng-model = "view.obj.address">
            </div>
          </div>
        </div>

        <div class = "row">
          <div class = "col-md-8 col-sm-6 col-xs-12">
            <div class = "form-group">
              <label>Works in department</label>
              <input type = "text" class = "form-control" readonly ng-value = "depName(view.obj)">
            </div>
          </div>

          <div class = "col-md-4 col-sm-6 col-xs-12">
            <div class = "form-group">
              <label>Since</label>
              <input type = "text" class = "date-input-value-copy" ng-model = "view.obj.employee.hired">
              <div class = "input-group">
                <input type = "text" class = "form-control" readonly
                  ng-value = "view.obj.employee.hired | date : 'MMMM d, yyyy' : 'UTC'"
                  ag-init = "$scope.initDatePicker($element, $element.parent().prev())">
                <div class = "input-group-addon"><span class = "btn btn-icon"><i class = "fa fa-calendar-o"></i></span></div>
              </div>
            </div>
          </div>
        </div>

        <div class = "row">
          <div class = "col-sm-6 col-xs-12">
            <div class = "form-group">
              <label>Work email</label>
              <input type = "text" class = "form-control" ng-model = "view.obj.employee.email">
            </div>
          </div>

          <div class = "col-sm-6 col-xs-12">
            <div class = "form-group">
              <label>Work phone</label>
              <input type = "text" class = "form-control" ng-model = "view.obj.employee.phone">
            </div>
          </div>
        </div>

        <div ag-trim class = "buttons">
          <div class = "left">
            <button ng-click = "view.obj = view.seldep = null"
              class = "btn btn-default">Close</button>
            <button class = "btn btn-info" ng-click = "gotoDep(e)">View department</button>
          </div>

          <div class = "right">
            <button ng-click = "view.seldep = (view.seldep == e.uuid)?(null):(e.uuid)"
              class = "btn btn-warning">Select department</button>
            <button class = "btn btn-success" ng-click = "submitEmp()"
              ng-disabled = "NU != view.obj.uuid && ZeT.deepEquals(view.obj, e)">Commit</button>
          </div>
        </div>
      </form>
    </div>

    <!-- list all the departments to select -->
    <div ng-repeat = "d in listAllDeps(e) track by d.uuid"
      class = "section-list-repeated inner alter department"
      ng-class = "{odd: $odd}">

      <div class = "compacted line">
        <div class = "icons">
          <table>
            <tr>
              <td><span ng-click = "view.obj.employee.department = d.uuid; view.seldep = null"
                class = "btn btn-icon"><i class = "fa fa-check-square-o"></i></span></td>
            </tr>
          </table>
        </div>
        <div class = "name">{{d.name}}</div>
      </div>
    </div>

    <div class = "section-list-sep" ng-repeat-end></div>
  </div>
</section>